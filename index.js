r=Math.random;
k=9;onkeydown=e=>k=e.which%32;onkeyup=e=>(k=e.which%32==k?9:k);
s=[-1,-25,1,25,0];

j=[];h=26;p=l=0;
for(i=0;i<325;i++){
	x=i%25;y=~~(i/25);
	j.push((i==27||i==51||i==h)?0:!(y%2)&&!(x%2)||!y||y==12||!x||x==24?1:r()<.5?4:r()<.05?3:0);
}

o=(e,{x,y},l)=>{
	for(i=0;i<49;i++)
		(!i&&l||i&&(+parseInt(e,36).toString(2)[i]^l))&&c.fillRect(x+(i%7),y+~~(i/7),1,1)
};

c.scale(5, 5);
setInterval(()=>{
	!k&&!p&&(j[h]=2)&&(p=90);
	!(l%3)&&(g=h+s[k-5]||h,h=!j[g]?g:h);
	p&&(p--);

	j.forEach((u,i)=>{
		!(l%10)&&u==3&&(g=s[~~(r()*4)],!j[i+g]&&(j[i+g]=3)&&(j[i]=0));
		u==2&&p==1&&s.forEach(n=>j[i+n]=j[i+n]-1?0:1);
	});
	c.clearRect(0,0,875,455);
	j.forEach((u,i)=>{
		x=7*(i%25);y=7*~~(i/25);
		o(['','','34L9HV8XDS','5E4I8C3K74','2S18HVN1KA','2S4A18IPSK'][i==h?5:u],{x,y},u==1)
	});
	l++
},30)

// 752
// 764 - one line

// 1 - wall;
// 2 - bomb;
// 3 - monster;
// 4 - brick;
// 5 - character (only for rendering, does not exist on the map)


// lo=(a,b)=>{for(ii=0;ii<a;ii++)b(ii);};

// Bomb
// 1001000
// 0011100
// 0100010
// 0100110
// 0100010
// 0011100
// 0000000

// 1001000001110001000100100110010001000111000000000
// 34L9HV8XDS

// --------------------------------

// Character

// 1100010
// 0011100
// 0100010
// 0110110
// 0100010
// 0111110
// 0010100

// 1100010001110001000100110110010001001111100010100
// 1000000001110001000100110110010001001111100010100
// 494GTA1250 || 2S4A18IPSK

// --------------------------------

// Monster
// bc,42,55,41,55,2a
// bc425541552a

// 1111100
// 1000010
// 1010101
// 1000001
// 1010101
// 0101010
// 0000000

// 1111100100001010101011000001101010101010100000000
// 5E4I8C3K74

// --------------------------------
// Bricks
// aa,55,aa,55,aa,55
// aa55aa55aa55
// 1UDXHXVWB9

// 10101010
// 01010101
// 10101010
// 01010101
// 10101010
// 01010101

// Bricks 2
// aa,55,2a,55,2a,55
// aa552a552a55
// 1UDWIFB61H

// 10101010
// 01010101
// 00101010
// 01010101
// 00101010
// 01010101
// -------------------------------------

// Bricks 3

// 1000000
// 0010101
// 0101010
// 0010101
// 0101010
// 0010101
// 0101010

// 1000000001010101010100010101010101000101010101010
// 2S18HVN1KA

// -------------------------------------

// 00000000
// 00000000
// 00000000
// 00000000
// 00000000
// 00000000
// 00000000
// 00000000

// a - -----;
// b - -----
// c - -----;
// d - render bricks;
// e - player, bomb, monster code string;
// f - Math.floor;
// g - player coords next
// h - player coords;
// i - Iterations
// j - main map;
// k - Key
// l -
// m - aka y;
// n - aka x;
// o - player, bomb, monster render function;
// p - Bomb
// q - [x, y] of global position
// r - Math.random
// s - Movements array
// t - update monsters positions;
// u - pressed key;
// v - c.fillRect;
// w - Monsters
// x - coords
// y - coords
// z - boom;


// Draw player, monster, bomb
// o=(e,{x,y})=>{
// 	for(i=0;i<16;i++){
// 		s=parseInt(e[i],16);
// 		n=x+(i%2)*4;
// 		m=y+~~(i/2);
// 		(s>>3)%2&&v(n,m,1,1);
// 		(s>>2)%2&&v(n+1,m,1,1);
// 		(s>>1)%2&&v(n+2,m,1,1);
// 		s%2&&v(n+3,m,1,1);
// 	}
// };

// Clean after bomb detonated;
// z=i=>{
// 	j[i]=0;
// 	j[i-1]=j[i-1]-1?0:1;
// 	j[i+1]=j[i+1]-1?0:1;
// 	j[i+25]=j[i+25]-1?0:1;
// 	j[i-25]=j[i-25]-1?0:1;
// };

// Monster movements
// t=i=>{
// 	g=~~(Math.random()*4);
// 	!g&&!j[i-1]&&(j[i-1]=3)&&(j[i]=0);
// 	g==1&&!j[i+1]&&(j[i+1]=3)&&(j[i]=0);
// 	g==2&&!j[i-25]&&(j[i-25]=3)&&(j[i]=0);
// 	g==3&&!j[i+25]&&(j[i+25]=3)&&(j[i]=0);
// };


// d=q=>{for(i=0;i<64;i++){(i%2)&&(~~(i/8)%2)&&v(q.x+i%8,q.y+~~(i/8),1,1);}};

// i==h&&(o('2S4A18IPSK',{x,y},1));
// u==2&&(o('34L9HV8XDS',{x,y}));
// u==3&&(o('5E4I8C3K74',{x,y}));
// u==4&&(o('2S18HVN1KA',{x,y}));
// u==1&&v(x,y,7,7);
